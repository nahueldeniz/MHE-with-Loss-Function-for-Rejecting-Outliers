----------------------------------------------------------------------------------------------------------------------------
Editor
----------------------------------------------------------------------------------------------------------------------------
The paper presents a moving horizon estimation technique for agricultural vehicles. A key aspect of the approach is an adaptive loss function, enabling it to handle GNSS outliers for improved accuracy. The reviewers acknowledge the method's practical relevance and agree that it is well-explained. However, the paper lacks sufficient experimental comparisons, key ablation studies, and real-world validation to support its applicability. The claim of real-time performance is unproven, and important design choices are not fully explained. While the simulations are relevant, their scope is limited. I recommend that the authors revise their contribution to better align the paper’s claims with its experimental findings and, if they successfully implement all the reviewers' suggestions, consider resubmitting to RA-L in the future.
-----------------------------------------------------------------------------------
R1
-----------------------------------------------------------------------------------
The paper presents an approach to use an adaptive loss function for solving the moving horizon estimation (MHE) problem, specifically for an N-trailer vehicle that could be employed in agricultural fields.
The authors effectively motivate the need for a robust estimation procedure, given the noise inherent in GNSS signals and the difficulty of modeling outlier measurements, particularly when they occur in bursts. The main contribution of the paper is the integration of an adaptive loss function into the MHE framework.

However, the claim of real-time applicability remains unsubstantiated. There is no demonstration on real data from an agricultural vehicle, nor any computational analysis to support this claim. This lack of evidence undermines one of the paper's key assertions.

The related works section provides a wide list of estimation approaches used to handle outliers. However, the presentation would benefit from categorizing the methods based on defining criteria or characteristics. Such categorization would make it easier for readers to understand the context and comparative strengths of each method.
While the authors summarize how their approach relates to existing works at the end of this section, the comparison lacks depth. Providing more detailed comparative statements for different "families" of methods would greatly enhance the reader's understanding of the state-of-the-art and how this paper's contribution fits into the broader context.
The methods section is well-structured, with clear and consistent notation throughout. The descriptions of the N-trailer vehicle kinematics (Section III.A) and the adaptive loss function (Section III.B) provide sufficient background for understanding the proposed approach.
In Section III.C, the authors propose using the square of the derivative of Barrons loss function as the adaptive loss function. However, the reason behind this choice is unclear. Why not use the original loss function directly? It would be helpful to explain the advantages of this choice explicitly. Additionally, the relationship between this approach and the iterative reweighted least squares framework, as discussed in [17,12], could be clarified further.
Another point of concern is Section III.E, where it seems that the value of alpha must be computed a priori. This raises the question: why not simply use a fixed robust kernel? My understanding is that adaptive robust kernels are designed to adjust the "loss shape" dynamically based on the residual distribution. Clarifying this issue would improve the section.
The experimental evaluation is conducted in simulation, with scenarios involving both gross outliers and burst outliers. These scenarios seem reasonable; however, it is unclear whether the presented results are from a single instance or a summary over multiple runs. Ideally, results should reflect averages or statistical summaries over numerous (e.g., thousands of) runs.
In Section IV.A, the results for a fixed alpha value of 1 appear to correspond to the use of a Huber loss. If this is the case, what is the advantage of using the proposed adaptive loss? An ablation study comparing the performance of fixed kernels and the adaptive kernel over several runs would be valuable to clarify this.
Finally, the lack of a demonstration on real data is a significant drawback. Given the papers focus on agricultural application, a real-world validation is expected. Without this, the practical applicability of the method remains uncertain.
----------------------------------------------------------------------------------------------------------------------------
R2
----------------------------------------------------------------------------------------------------------------------------
Overview
The manuscript presents a novel Moving Horizon Estimation (MHE) approach for autonomous agricultural vehicles, designed to address GNSS measurement outliers prevalent in agricultural environments. The authors propose replacing the traditional L2 stage cost with a general adaptive robust loss function, enhancing robustness against measurement noise and outliers. The approach is validated through simulations comparing it against standard MHE and a generalized MHE based on Bayesian theory.
While the manuscript demonstrates promise and presents interesting results, several areas require further clarification, theoretical support, and additional validation before it can be considered for publication.
Major problems are noted as follows: 1. The authors propose using a general adaptive robust loss function but provide limited justification for its selection over other robust alternatives like the Huber loss or Tukey’s biweight loss. It would be helpful to explain why this specific loss function was chosen and to provide theoretical or experimental comparisons with these methods.
2. While the manuscript discusses the tuning of parameters α and c, the rationale for their values remains unclear. Further explanation is needed on how these parameters influence estimation robustness and how they can be generalized across different noise and outlier scenarios. Sensitivity analysis on α and c across various conditions would strengthen the argument.
3. The manuscript evaluates the proposed method under specific simulation conditions (e.g., path-following tasks). However, broader scenarios, such as varying GNSS outage durations, non-Gaussian noise, and multi-sensor fusion, should be considered to demonstrate the method's generalizability and robustness in real-world conditions.
4. Although real-time applicability is claimed, the manuscript lacks a detailed analysis of computational complexity. Providing benchmarks or comparisons of computational times between the proposed method, standard MHE, and generalized MHE under varying window lengths and noise levels would substantiate the claim of real-time feasibility.
5. The results are based solely on simulations. Including real-world experiments with GNSS data affected by known outliers would provide stronger evidence of the method's practical effectiveness and applicability.

6. The manuscript compares the proposed approach with a generalized MHE method but does not include other recent state-of-the-art methods for outlier handling, such as particle filters or machine-learning-based estimators. Incorporating such  comparisons would better position the proposed method within the broader literature.
Other problems:
1. The formatting of the equations should be consistent. Currently, some equations include colons, commas, or units. Please standardize the formatting for uniformity.
2. There is an issue with the formatting of Reference 9. Please review all references to ensure their correctness and adherence to the required style.
3. The affiliation details and superscripts on the first page of the paper have issues. Please refer to other RAL journal papers for proper formatting and corrections.
----------------------------------------------------------------------------------------------------------------------------
R3
----------------------------------------------------------------------------------------------------------------------------
The authors present a novel Moving Horizon Estimator with plenty of applications to outdoor robotic systems that rely on GNSS for their navigation. The concept is really useful and widely used in real-world applications, making this paper important for the domain of outdoor robots. The authors clearly state the state of these applications and the necessity for more accurate GNSS-based localization in their introduction, placing their work between other relevant works. Also, the related work analysis is really descriptive, the categorization of the works is clear and the authors clearly state the real contribution of this work compated to the state-of-the-art.

Regarding the problem statement, the authors properly introduce the notation used throughout the text, and introduce the necessary mathematical symbols. These are all kept consistent throughout the text, making it easy for the reader to follow. Also the method is clearly described and referenced are added, wherever is essential. 

In the experiments, the authors validate their method in a specific path of simulated data, adapting plenty of parameters to justify the contribution of their work. Something that should be considered is whether this track is suitable for the evaluation, or if more trajectories should be considered. Specifically, trajectories that reflect real-world scenarios of outdoor agricultural robots. Ideally, real-world experiments either from a robot or datasets would be a great contribution for this work! The analysis and the metrics clearly demonstrate the effectiveness of
this work and its contribution in the ‘real-world’ factors that is needed. Also, it is good that the compared work is a recent work that implements a similar method, but clearly the present work is better. 

The paper reaches accurate conclusions that justify the contributions of this work. It would be nice to add a mention to the potential future work that the authors would make, in order to further improve such
methods. 

In general, the appearance of the paper is very good and only minor issues have been identified. Specifically: 
In Section III-C, first paragraph: “The rationale behind of choosing the the square of the derivative is that this new function include all the behaviours of the Eq. (2) and news for &#945; < 1.” In this sentence, “news” does not make sense in my opinion and something else should be written, or make it more clear.
In Section IV: “using the model predictive controlled presented in” &#8594; “controller” In Section IV: “(xref,k, , yref,k” &#8594; here there is an additional comma, which is not needed In figure 4, for y(m) the caption mentions a yellow dashed line, but in the figure it’s blue. This should be fixed.


